terraform {
  required_version = ">= 0.13"

  required_providers {
    azurerm = {
      source  = "hashicorp/azurerm"
      version = ">=2.29.0"
    }
  }
}
locals {
  list = []
}

resource "azurerm_policy_definition" "base" {
  for_each              = fileset("${path.module}/templates", "**/rule.json")
  name                  = substr("log-${replace(each.value, "/rule.json", "")}", 0, 54)
  policy_type           = "Custom"
  management_group_name = var.management_group_name
  mode                  = "All"
  display_name          = "Diagnostic policy ${replace(each.value, "/rule.json", "")}"
  policy_rule = file(
    "${path.module}/templates/${each.value}",
  )
  parameters = file(
    "${path.module}/templates/${replace(each.value, "/rule.json", "/parameters.json")}",
  )
}


resource "azurerm_policy_set_definition" "basic_set" {
  name                  = var.name
  policy_type           = "Custom"
  display_name          = var.name
  management_group_name = var.management_group_name
  parameters            = <<PARAMETERS
    {
    "requiredRetentionDays": {
      "type": "String",
      "metadata": {
        "displayName": "Required retention (days)",
        "description": "The required diagnostic logs retention in days"
      },
      "defaultValue": "365"
    },
    "eventHubName": {
        "type": "String",
        "metadata":{
            "displayName": "Event hub to send the data to",
            "description": ""
        },
        "defaultValue": ""
    },
    "eventHubAuthorizationRuleId": {
        "type": "String",
        "metadata":{
            "displayName": "Event hub rule to be used to send data",
            "description": ""
        },
        "defaultValue": ""
    },
    "workspaceId": {
        "type": "String",
        "metadata":{
            "displayName": "Log analytics workspace id to send the data to",
            "description": ""
        },
        "defaultValue": ""
    },
    "storageAccountName": {
        "type": "String",
        "metadata":{
            "displayName": "Storage account to send the data to",
            "description": ""
        },
        "defaultValue": ""
    },
    "resourceLocation": {
        "type": "Array",
        "metadata": {
          "description": "locations that you want to enable diagnotics to",
          "displayName": "location where disgnostics will be enabled",
          "strongType": "location"
        },
        "defaultValue": [
            "eastus",
            "eastus2",
            "southcentralus",
            "westus2",
            "australiaeast",
            "southeastasia",
            "northeurope",
            "uksouth",
            "westeurope",
            "centralus",
            "northcentralus",
            "westus",
            "southafricanorth",
            "centralindia",
            "eastasia",
            "japaneast",
            "koreacentral",
            "canadacentral",
            "francecentral",
            "germanywestcentral",
            "norwayeast",
            "switzerlandnorth",
            "uaenorth",
            "brazilsouth",
            "centralusstage",
            "eastusstage",
            "eastus2stage",
            "northcentralusstage",
            "southcentralusstage",
            "westusstage",
            "westus2stage",
            "asia",
            "asiapacific",
            "australia",
            "brazil",
            "canada",
            "europe",
            "global",
            "india",
            "japan",
            "uk",
            "unitedstates",
            "eastasiastage",
            "southeastasiastage",
            "eastus2euap",
            "westcentralus",
            "southafricawest",
            "australiacentral",
            "australiacentral2",
            "australiasoutheast",
            "japanwest",
            "koreasouth",
            "southindia",
            "westindia",
            "canadaeast",
            "francesouth",
            "germanynorth",
            "norwaywest",
            "switzerlandwest",
            "ukwest",
            "uaecentral",
            "brazilsoutheast"
          ]
    }
}
PARAMETERS

  dynamic "policy_definition_reference" {
    for_each = azurerm_policy_definition.base
    content {
      policy_definition_id = policy_definition_reference.value.id
      parameter_values     = <<EOL
          {
            "eventHubAuthorizationRuleId": {"value": "[parameters('eventHubAuthorizationRuleId')]"},
            "eventHubName": {"value": "[parameters('eventHubName')]"},
            "requiredRetentionDays": {"value": "[parameters('requiredRetentionDays')]"},
            "resourceLocation": {"value": "[parameters('resourceLocation')]"},
            "storageAccountName": {"value": "[parameters('storageAccountName')]"},
            "workspaceId": {"value": "[parameters('workspaceId')]"}
          }
          EOL


      # parameters = {
      #   requiredRetentionDays       = "[parameters('requiredRetentionDays')]",
      #   eventHubName                = "[parameters('eventHubName')]",
      #   eventHubAuthorizationRuleId = "[parameters('eventHubAuthorizationRuleId')]",
      #   workspaceId                 = "[parameters('workspaceId')]",
      #   storageAccountName          = "[parameters('storageAccountName')]",
      #   resourceLocation            = "[parameters('resourceLocation')]",
      # }

    }

  }

  lifecycle {
    ignore_changes = [metadata,
      # I Know this is UGLY but this is the only way to get this working for now bugs on the provider and terraform
      policy_definition_reference.0.parameters,
      policy_definition_reference.1.parameters,
      policy_definition_reference.2.parameters,
      policy_definition_reference.3.parameters,
      policy_definition_reference.4.parameters,
      policy_definition_reference.5.parameters,
      policy_definition_reference.6.parameters,
      policy_definition_reference.7.parameters,
      policy_definition_reference.8.parameters,
      policy_definition_reference.9.parameters,
      policy_definition_reference.10.parameters,
      policy_definition_reference.11.parameters,
      policy_definition_reference.12.parameters,
      policy_definition_reference.13.parameters,
      policy_definition_reference.14.parameters,
      policy_definition_reference.15.parameters,
      policy_definition_reference.16.parameters,
      policy_definition_reference.17.parameters,
      policy_definition_reference.18.parameters,
      policy_definition_reference.19.parameters,
      policy_definition_reference.20.parameters,
      policy_definition_reference.21.parameters,
      policy_definition_reference.22.parameters,
      policy_definition_reference.23.parameters,
      policy_definition_reference.24.parameters,
      policy_definition_reference.25.parameters,
      policy_definition_reference.26.parameters,
      policy_definition_reference.27.parameters,
      policy_definition_reference.28.parameters,
      policy_definition_reference.29.parameters,
      policy_definition_reference.30.parameters,
      policy_definition_reference.31.parameters,
      policy_definition_reference.32.parameters,
      policy_definition_reference.33.parameters,
      policy_definition_reference.34.parameters,
      policy_definition_reference.35.parameters,
      policy_definition_reference.36.parameters,
      policy_definition_reference.37.parameters,
      policy_definition_reference.38.parameters,
      policy_definition_reference.39.parameters,
      policy_definition_reference.40.parameters,
      policy_definition_reference.41.parameters,
      policy_definition_reference.42.parameters,
      policy_definition_reference.43.parameters,
      policy_definition_reference.44.parameters,
      policy_definition_reference.45.parameters,
      policy_definition_reference.46.parameters,
      policy_definition_reference.47.parameters,
      policy_definition_reference.48.parameters,
      policy_definition_reference.49.parameters,
      policy_definition_reference.50.parameters,
      policy_definition_reference.51.parameters,
      policy_definition_reference.52.parameters,
      policy_definition_reference.53.parameters,
      policy_definition_reference.54.parameters,
      policy_definition_reference.55.parameters,
      policy_definition_reference.56.parameters,
      policy_definition_reference.57.parameters,
      policy_definition_reference.58.parameters,
      policy_definition_reference.59.parameters,
      policy_definition_reference.60.parameters,
      policy_definition_reference.61.parameters,
      policy_definition_reference.62.parameters,
      policy_definition_reference.63.parameters,
      policy_definition_reference.64.parameters,
      policy_definition_reference.65.parameters,
      policy_definition_reference.66.parameters,
      policy_definition_reference.67.parameters,
      policy_definition_reference.68.parameters,
      policy_definition_reference.69.parameters,
      policy_definition_reference.70.parameters,
      policy_definition_reference.71.parameters,
      policy_definition_reference.72.parameters,
      policy_definition_reference.73.parameters,
      policy_definition_reference.74.parameters,
      policy_definition_reference.75.parameters,
      policy_definition_reference.76.parameters,
      policy_definition_reference.77.parameters,
      policy_definition_reference.78.parameters,
      policy_definition_reference.79.parameters,
      policy_definition_reference.80.parameters,
      policy_definition_reference.81.parameters,
      policy_definition_reference.82.parameters,
      policy_definition_reference.83.parameters,
      policy_definition_reference.84.parameters,
      policy_definition_reference.85.parameters,
      policy_definition_reference.86.parameters,
      policy_definition_reference.87.parameters,
      policy_definition_reference.88.parameters,
      policy_definition_reference.89.parameters,
      policy_definition_reference.90.parameters,
      policy_definition_reference.91.parameters,
      policy_definition_reference.92.parameters,
      policy_definition_reference.93.parameters,
      policy_definition_reference.94.parameters,
      policy_definition_reference.95.parameters,
      policy_definition_reference.96.parameters,
      policy_definition_reference.97.parameters,
      policy_definition_reference.98.parameters,
      policy_definition_reference.99.parameters,
      policy_definition_reference.100.parameters,
      policy_definition_reference.101.parameters,
      policy_definition_reference.102.parameters,
      policy_definition_reference.103.parameters,
      policy_definition_reference.104.parameters,
      policy_definition_reference.105.parameters,
      policy_definition_reference.106.parameters,
      policy_definition_reference.107.parameters,
      policy_definition_reference.108.parameters,
      policy_definition_reference.109.parameters,
      policy_definition_reference.110.parameters,
      policy_definition_reference.111.parameters,
      policy_definition_reference.112.parameters,
      policy_definition_reference.113.parameters,
      policy_definition_reference.114.parameters,
      policy_definition_reference.115.parameters,
      policy_definition_reference.116.parameters,
      policy_definition_reference.117.parameters,
      policy_definition_reference.118.parameters,
      policy_definition_reference.119.parameters,
      policy_definition_reference.120.parameters,
      policy_definition_reference.121.parameters,
      policy_definition_reference.122.parameters,
      policy_definition_reference.123.parameters,
      policy_definition_reference.124.parameters,
      policy_definition_reference.125.parameters,
      policy_definition_reference.126.parameters,
      policy_definition_reference.127.parameters,
      policy_definition_reference.128.parameters,
      policy_definition_reference.129.parameters,
      policy_definition_reference.130.parameters,
      policy_definition_reference.131.parameters,
      policy_definition_reference.132.parameters,
      policy_definition_reference.133.parameters,
      policy_definition_reference.134.parameters,
      policy_definition_reference.135.parameters,
      policy_definition_reference.136.parameters,
      policy_definition_reference.137.parameters,
      policy_definition_reference.138.parameters,
      policy_definition_reference.139.parameters,
      policy_definition_reference.140.parameters,
      policy_definition_reference.141.parameters,
      policy_definition_reference.142.parameters,
      policy_definition_reference.143.parameters,
      policy_definition_reference.144.parameters,
      policy_definition_reference.145.parameters,
      policy_definition_reference.146.parameters,
      policy_definition_reference.147.parameters,
      policy_definition_reference.148.parameters,
      policy_definition_reference.149.parameters,
      policy_definition_reference.150.parameters,
      policy_definition_reference.151.parameters,
      policy_definition_reference.152.parameters,
      policy_definition_reference.153.parameters,
      policy_definition_reference.154.parameters,
      policy_definition_reference.155.parameters,
      policy_definition_reference.156.parameters,
      policy_definition_reference.157.parameters,
      policy_definition_reference.158.parameters,
      policy_definition_reference.159.parameters,
      policy_definition_reference.160.parameters,
      policy_definition_reference.161.parameters,
      policy_definition_reference.162.parameters,
      policy_definition_reference.163.parameters,
      policy_definition_reference.164.parameters,
      policy_definition_reference.165.parameters,
      policy_definition_reference.166.parameters,
      policy_definition_reference.167.parameters,
      policy_definition_reference.168.parameters,
      policy_definition_reference.169.parameters,
      policy_definition_reference.170.parameters,
      policy_definition_reference.171.parameters,
      policy_definition_reference.172.parameters,
      policy_definition_reference.173.parameters,
      policy_definition_reference.174.parameters,
      policy_definition_reference.175.parameters,
      policy_definition_reference.176.parameters,
      policy_definition_reference.177.parameters,
      policy_definition_reference.178.parameters,
      policy_definition_reference.179.parameters,
      policy_definition_reference.180.parameters,
      policy_definition_reference.181.parameters,
      policy_definition_reference.182.parameters,
      policy_definition_reference.183.parameters,
      policy_definition_reference.184.parameters,
      policy_definition_reference.185.parameters,
      policy_definition_reference.186.parameters,
      policy_definition_reference.187.parameters,
      policy_definition_reference.188.parameters,
      policy_definition_reference.189.parameters,
      policy_definition_reference.190.parameters,
      policy_definition_reference.191.parameters,
      policy_definition_reference.192.parameters,
      policy_definition_reference.193.parameters,
      policy_definition_reference.194.parameters,
      policy_definition_reference.195.parameters,
      policy_definition_reference.196.parameters,
      policy_definition_reference.197.parameters,
      policy_definition_reference.198.parameters,
      policy_definition_reference.199.parameters,
      policy_definition_reference.200.parameters,
      policy_definition_reference.201.parameters,
      policy_definition_reference.202.parameters,
      policy_definition_reference.203.parameters,
      policy_definition_reference.204.parameters,
      policy_definition_reference.205.parameters,
      policy_definition_reference.206.parameters,
      policy_definition_reference.207.parameters,
      policy_definition_reference.208.parameters,
      policy_definition_reference.209.parameters,
      policy_definition_reference.210.parameters,
      policy_definition_reference.211.parameters,
      policy_definition_reference.212.parameters,
      policy_definition_reference.213.parameters,
      policy_definition_reference.214.parameters,
      policy_definition_reference.215.parameters,
      policy_definition_reference.216.parameters,
      policy_definition_reference.217.parameters,
      policy_definition_reference.218.parameters,
      policy_definition_reference.219.parameters,
      policy_definition_reference.220.parameters,
      policy_definition_reference.221.parameters,
      policy_definition_reference.222.parameters,
      policy_definition_reference.223.parameters,
      policy_definition_reference.224.parameters,
      policy_definition_reference.225.parameters,
      policy_definition_reference.226.parameters,
      policy_definition_reference.227.parameters,
      policy_definition_reference.228.parameters,
      policy_definition_reference.229.parameters,
      policy_definition_reference.230.parameters,
      policy_definition_reference.231.parameters,
      policy_definition_reference.232.parameters,
      policy_definition_reference.233.parameters,
      policy_definition_reference.234.parameters,
      policy_definition_reference.235.parameters,
      policy_definition_reference.236.parameters,
      policy_definition_reference.237.parameters,
      policy_definition_reference.238.parameters,
      policy_definition_reference.239.parameters,
      policy_definition_reference.240.parameters,
      policy_definition_reference.241.parameters,
      policy_definition_reference.242.parameters,
      policy_definition_reference.243.parameters,
      policy_definition_reference.244.parameters,
      policy_definition_reference.245.parameters,
      policy_definition_reference.246.parameters,
      policy_definition_reference.247.parameters,
      policy_definition_reference.248.parameters,
      policy_definition_reference.249.parameters,
      policy_definition_reference.250.parameters,
      policy_definition_reference.251.parameters,
      policy_definition_reference.252.parameters,
      policy_definition_reference.253.parameters,
      policy_definition_reference.254.parameters,
      policy_definition_reference.255.parameters,
      policy_definition_reference.256.parameters,
      policy_definition_reference.257.parameters,
      policy_definition_reference.258.parameters,
      policy_definition_reference.259.parameters,
      policy_definition_reference.260.parameters,
      policy_definition_reference.261.parameters,
      policy_definition_reference.262.parameters,
      policy_definition_reference.263.parameters,
      policy_definition_reference.264.parameters,
      policy_definition_reference.265.parameters,
      policy_definition_reference.266.parameters,
      policy_definition_reference.267.parameters,
      policy_definition_reference.268.parameters,
      policy_definition_reference.269.parameters,
      policy_definition_reference.270.parameters,
      policy_definition_reference.271.parameters,
      policy_definition_reference.272.parameters,
      policy_definition_reference.273.parameters,
      policy_definition_reference.274.parameters,
      policy_definition_reference.275.parameters,
      policy_definition_reference.276.parameters,
      policy_definition_reference.277.parameters,
      policy_definition_reference.278.parameters,
      policy_definition_reference.279.parameters,
      policy_definition_reference.280.parameters,
      policy_definition_reference.281.parameters,
      policy_definition_reference.282.parameters,
      policy_definition_reference.283.parameters,
      policy_definition_reference.284.parameters,
      policy_definition_reference.285.parameters,
      policy_definition_reference.286.parameters,
      policy_definition_reference.287.parameters,
      policy_definition_reference.288.parameters,
      policy_definition_reference.289.parameters,
      policy_definition_reference.290.parameters,
      policy_definition_reference.291.parameters,
      policy_definition_reference.292.parameters,
      policy_definition_reference.293.parameters,
      policy_definition_reference.294.parameters,
      policy_definition_reference.295.parameters,
      policy_definition_reference.296.parameters,
      policy_definition_reference.297.parameters,
      policy_definition_reference.298.parameters,
      policy_definition_reference.299.parameters,
      policy_definition_reference.300.parameters,
      policy_definition_reference.301.parameters,
      policy_definition_reference.302.parameters,
      policy_definition_reference.303.parameters,
      policy_definition_reference.304.parameters,
      policy_definition_reference.305.parameters,
      policy_definition_reference.306.parameters,
      policy_definition_reference.307.parameters,
      policy_definition_reference.308.parameters,
      policy_definition_reference.309.parameters,
      policy_definition_reference.310.parameters,
      policy_definition_reference.311.parameters,
      policy_definition_reference.312.parameters,
      policy_definition_reference.313.parameters,
      policy_definition_reference.314.parameters,
      policy_definition_reference.315.parameters,
      policy_definition_reference.316.parameters,
      policy_definition_reference.317.parameters,
      policy_definition_reference.318.parameters,
      policy_definition_reference.319.parameters,
      policy_definition_reference.320.parameters,
      policy_definition_reference.321.parameters,
      policy_definition_reference.322.parameters,
      policy_definition_reference.323.parameters,
      policy_definition_reference.324.parameters,
      policy_definition_reference.325.parameters,
      policy_definition_reference.326.parameters,
      policy_definition_reference.327.parameters,
      policy_definition_reference.328.parameters,
      policy_definition_reference.329.parameters,
      policy_definition_reference.330.parameters,
      policy_definition_reference.331.parameters,
      policy_definition_reference.332.parameters,
      policy_definition_reference.333.parameters,
      policy_definition_reference.334.parameters,
      policy_definition_reference.335.parameters,
      policy_definition_reference.336.parameters,
      policy_definition_reference.337.parameters,
      policy_definition_reference.338.parameters,
      policy_definition_reference.339.parameters,
      policy_definition_reference.340.parameters,
      policy_definition_reference.341.parameters,
      policy_definition_reference.342.parameters,
      policy_definition_reference.343.parameters,
      policy_definition_reference.344.parameters,
      policy_definition_reference.345.parameters,
      policy_definition_reference.346.parameters,
      policy_definition_reference.347.parameters,
      policy_definition_reference.348.parameters,
      policy_definition_reference.349.parameters,
      policy_definition_reference.350.parameters,
      policy_definition_reference.351.parameters,
      policy_definition_reference.352.parameters,
      policy_definition_reference.353.parameters,
      policy_definition_reference.354.parameters,
      policy_definition_reference.355.parameters,
      policy_definition_reference.356.parameters,
      policy_definition_reference.357.parameters,
      policy_definition_reference.358.parameters,
      policy_definition_reference.359.parameters,
      policy_definition_reference.360.parameters,
      policy_definition_reference.361.parameters,
      policy_definition_reference.362.parameters,
      policy_definition_reference.363.parameters,
      policy_definition_reference.364.parameters,
      policy_definition_reference.365.parameters,
      policy_definition_reference.366.parameters,
      policy_definition_reference.367.parameters,
      policy_definition_reference.368.parameters,
      policy_definition_reference.369.parameters,
      policy_definition_reference.370.parameters,
      policy_definition_reference.371.parameters,
      policy_definition_reference.372.parameters,
      policy_definition_reference.373.parameters,
      policy_definition_reference.374.parameters,
      policy_definition_reference.375.parameters,
      policy_definition_reference.376.parameters,
      policy_definition_reference.377.parameters,
      policy_definition_reference.378.parameters,
      policy_definition_reference.379.parameters,
      policy_definition_reference.380.parameters,
      policy_definition_reference.381.parameters,
      policy_definition_reference.382.parameters,
      policy_definition_reference.383.parameters,
      policy_definition_reference.384.parameters,
      policy_definition_reference.385.parameters,
      policy_definition_reference.386.parameters,
      policy_definition_reference.387.parameters,
      policy_definition_reference.388.parameters,
      policy_definition_reference.389.parameters,
      policy_definition_reference.390.parameters,
      policy_definition_reference.391.parameters,
      policy_definition_reference.392.parameters,
      policy_definition_reference.393.parameters,
      policy_definition_reference.394.parameters,
      policy_definition_reference.395.parameters,
      policy_definition_reference.396.parameters,
      policy_definition_reference.397.parameters,
      policy_definition_reference.398.parameters,
      policy_definition_reference.399.parameters,
      policy_definition_reference.400.parameters,
      policy_definition_reference.401.parameters,
      policy_definition_reference.402.parameters,
      policy_definition_reference.403.parameters,
      policy_definition_reference.404.parameters,
      policy_definition_reference.405.parameters,
      policy_definition_reference.406.parameters,
      policy_definition_reference.407.parameters,
      policy_definition_reference.408.parameters,
      policy_definition_reference.409.parameters,
      policy_definition_reference.410.parameters,
      policy_definition_reference.411.parameters,
      policy_definition_reference.412.parameters,
      policy_definition_reference.413.parameters,
      policy_definition_reference.414.parameters,
      policy_definition_reference.415.parameters,
      policy_definition_reference.416.parameters,
      policy_definition_reference.417.parameters,
      policy_definition_reference.418.parameters,
      policy_definition_reference.419.parameters,
      policy_definition_reference.420.parameters,
      policy_definition_reference.421.parameters,
      policy_definition_reference.422.parameters,
      policy_definition_reference.423.parameters,
      policy_definition_reference.424.parameters,
      policy_definition_reference.425.parameters,
      policy_definition_reference.426.parameters,
      policy_definition_reference.427.parameters,
      policy_definition_reference.428.parameters,
      policy_definition_reference.429.parameters,
      policy_definition_reference.430.parameters,
      policy_definition_reference.431.parameters,
      policy_definition_reference.432.parameters,
      policy_definition_reference.433.parameters,
      policy_definition_reference.434.parameters,
      policy_definition_reference.435.parameters,
      policy_definition_reference.436.parameters,
      policy_definition_reference.437.parameters,
      policy_definition_reference.438.parameters,
      policy_definition_reference.439.parameters,
      policy_definition_reference.440.parameters,
      policy_definition_reference.441.parameters,
      policy_definition_reference.442.parameters,
      policy_definition_reference.443.parameters,
      policy_definition_reference.444.parameters,
      policy_definition_reference.445.parameters,
      policy_definition_reference.446.parameters,
      policy_definition_reference.447.parameters,
      policy_definition_reference.448.parameters,
      policy_definition_reference.449.parameters,
      policy_definition_reference.450.parameters,
      policy_definition_reference.451.parameters,
      policy_definition_reference.452.parameters,
      policy_definition_reference.453.parameters,
      policy_definition_reference.454.parameters,
      policy_definition_reference.455.parameters,
      policy_definition_reference.456.parameters,
      policy_definition_reference.457.parameters,
      policy_definition_reference.458.parameters,
      policy_definition_reference.459.parameters,
      policy_definition_reference.460.parameters,
      policy_definition_reference.461.parameters,
      policy_definition_reference.462.parameters,
      policy_definition_reference.463.parameters,
      policy_definition_reference.464.parameters,
      policy_definition_reference.465.parameters,
      policy_definition_reference.466.parameters,
      policy_definition_reference.467.parameters,
      policy_definition_reference.468.parameters,
      policy_definition_reference.469.parameters,
      policy_definition_reference.470.parameters,
      policy_definition_reference.471.parameters,
      policy_definition_reference.472.parameters,
      policy_definition_reference.473.parameters,
      policy_definition_reference.474.parameters,
      policy_definition_reference.475.parameters,
      policy_definition_reference.476.parameters,
      policy_definition_reference.477.parameters,
      policy_definition_reference.478.parameters,
      policy_definition_reference.479.parameters,
      policy_definition_reference.480.parameters,
      policy_definition_reference.481.parameters,
      policy_definition_reference.482.parameters,
      policy_definition_reference.483.parameters,
      policy_definition_reference.484.parameters,
      policy_definition_reference.485.parameters,
      policy_definition_reference.486.parameters,
      policy_definition_reference.487.parameters,
      policy_definition_reference.488.parameters,
      policy_definition_reference.489.parameters,
      policy_definition_reference.490.parameters,
      policy_definition_reference.491.parameters,
      policy_definition_reference.492.parameters,
      policy_definition_reference.493.parameters,
      policy_definition_reference.494.parameters,
      policy_definition_reference.495.parameters,
      policy_definition_reference.496.parameters,
      policy_definition_reference.497.parameters,
      policy_definition_reference.498.parameters,
      policy_definition_reference.499.parameters,
      policy_definition_reference.500.parameters,
      policy_definition_reference.501.parameters,
      policy_definition_reference.502.parameters,
      policy_definition_reference.503.parameters,
      policy_definition_reference.504.parameters,
      policy_definition_reference.505.parameters,
      policy_definition_reference.506.parameters,
      policy_definition_reference.507.parameters,
      policy_definition_reference.508.parameters,
      policy_definition_reference.509.parameters,
      policy_definition_reference.510.parameters,
      policy_definition_reference.511.parameters,
      policy_definition_reference.512.parameters,
      policy_definition_reference.513.parameters,
      policy_definition_reference.514.parameters,
      policy_definition_reference.515.parameters,
      policy_definition_reference.516.parameters,
      policy_definition_reference.517.parameters,
      policy_definition_reference.518.parameters,
      policy_definition_reference.519.parameters,
      policy_definition_reference.520.parameters,
      policy_definition_reference.521.parameters,
      policy_definition_reference.522.parameters,
      policy_definition_reference.523.parameters,
      policy_definition_reference.524.parameters,
      policy_definition_reference.525.parameters,
      policy_definition_reference.526.parameters,
      policy_definition_reference.527.parameters,
      policy_definition_reference.528.parameters,
      policy_definition_reference.529.parameters,
      policy_definition_reference.530.parameters,
      policy_definition_reference.531.parameters,
      policy_definition_reference.532.parameters,
      policy_definition_reference.533.parameters,
      policy_definition_reference.534.parameters,
      policy_definition_reference.535.parameters,
      policy_definition_reference.536.parameters,
      policy_definition_reference.537.parameters,
      policy_definition_reference.538.parameters,
      policy_definition_reference.539.parameters,
      policy_definition_reference.540.parameters,
      policy_definition_reference.541.parameters,
      policy_definition_reference.542.parameters,
      policy_definition_reference.543.parameters,
      policy_definition_reference.544.parameters,
      policy_definition_reference.545.parameters,
      policy_definition_reference.546.parameters,
      policy_definition_reference.547.parameters,
      policy_definition_reference.548.parameters,
      policy_definition_reference.549.parameters,
      policy_definition_reference.550.parameters,
      policy_definition_reference.551.parameters,
      policy_definition_reference.552.parameters,
      policy_definition_reference.553.parameters,
      policy_definition_reference.554.parameters,
      policy_definition_reference.555.parameters,
      policy_definition_reference.556.parameters,
      policy_definition_reference.557.parameters,
      policy_definition_reference.558.parameters,
      policy_definition_reference.559.parameters,
      policy_definition_reference.560.parameters,
      policy_definition_reference.561.parameters,
      policy_definition_reference.562.parameters,
      policy_definition_reference.563.parameters,
      policy_definition_reference.564.parameters,
      policy_definition_reference.565.parameters,
      policy_definition_reference.566.parameters,
      policy_definition_reference.567.parameters,
      policy_definition_reference.568.parameters,
      policy_definition_reference.569.parameters,
      policy_definition_reference.570.parameters,
      policy_definition_reference.571.parameters,
      policy_definition_reference.572.parameters,
      policy_definition_reference.573.parameters,
      policy_definition_reference.574.parameters,
      policy_definition_reference.575.parameters,
      policy_definition_reference.576.parameters,
      policy_definition_reference.577.parameters,
      policy_definition_reference.578.parameters,
      policy_definition_reference.579.parameters,
      policy_definition_reference.580.parameters,
      policy_definition_reference.581.parameters,
      policy_definition_reference.582.parameters,
      policy_definition_reference.583.parameters,
      policy_definition_reference.584.parameters,
      policy_definition_reference.585.parameters,
      policy_definition_reference.586.parameters,
      policy_definition_reference.587.parameters,
      policy_definition_reference.588.parameters,
      policy_definition_reference.589.parameters,
      policy_definition_reference.590.parameters,
      policy_definition_reference.591.parameters,
      policy_definition_reference.592.parameters,
      policy_definition_reference.593.parameters,
      policy_definition_reference.594.parameters,
      policy_definition_reference.595.parameters,
      policy_definition_reference.596.parameters,
      policy_definition_reference.597.parameters,
      policy_definition_reference.598.parameters,
      policy_definition_reference.599.parameters,
      policy_definition_reference.600.parameters,
      policy_definition_reference.601.parameters,
      policy_definition_reference.602.parameters,
      policy_definition_reference.603.parameters,
      policy_definition_reference.604.parameters,
      policy_definition_reference.605.parameters,
      policy_definition_reference.606.parameters,
      policy_definition_reference.607.parameters,
      policy_definition_reference.608.parameters,
      policy_definition_reference.609.parameters,
      policy_definition_reference.610.parameters,
      policy_definition_reference.611.parameters,
      policy_definition_reference.612.parameters,
      policy_definition_reference.613.parameters,
      policy_definition_reference.614.parameters,
      policy_definition_reference.615.parameters,
      policy_definition_reference.616.parameters,
      policy_definition_reference.617.parameters,
      policy_definition_reference.618.parameters,
      policy_definition_reference.619.parameters,
      policy_definition_reference.620.parameters,
      policy_definition_reference.621.parameters,
      policy_definition_reference.622.parameters,
      policy_definition_reference.623.parameters,
      policy_definition_reference.624.parameters,
      policy_definition_reference.625.parameters,
      policy_definition_reference.626.parameters,
      policy_definition_reference.627.parameters,
      policy_definition_reference.628.parameters,
      policy_definition_reference.629.parameters,
      policy_definition_reference.630.parameters,
      policy_definition_reference.631.parameters,
      policy_definition_reference.632.parameters,
      policy_definition_reference.633.parameters,
      policy_definition_reference.634.parameters,
      policy_definition_reference.635.parameters,
      policy_definition_reference.636.parameters,
      policy_definition_reference.637.parameters,
      policy_definition_reference.638.parameters,
      policy_definition_reference.639.parameters,
      policy_definition_reference.640.parameters,
      policy_definition_reference.641.parameters,
      policy_definition_reference.642.parameters,
      policy_definition_reference.643.parameters,
      policy_definition_reference.644.parameters,
      policy_definition_reference.645.parameters,
      policy_definition_reference.646.parameters,
      policy_definition_reference.647.parameters,
      policy_definition_reference.648.parameters,
      policy_definition_reference.649.parameters,
      policy_definition_reference.650.parameters,
      policy_definition_reference.651.parameters,
      policy_definition_reference.652.parameters,
      policy_definition_reference.653.parameters,
      policy_definition_reference.654.parameters,
      policy_definition_reference.655.parameters,
      policy_definition_reference.656.parameters,
      policy_definition_reference.657.parameters,
      policy_definition_reference.658.parameters,
      policy_definition_reference.659.parameters,
      policy_definition_reference.660.parameters,
      policy_definition_reference.661.parameters,
      policy_definition_reference.662.parameters,
      policy_definition_reference.663.parameters,
      policy_definition_reference.664.parameters,
      policy_definition_reference.665.parameters,
      policy_definition_reference.666.parameters,
      policy_definition_reference.667.parameters,
      policy_definition_reference.668.parameters,
      policy_definition_reference.669.parameters,
      policy_definition_reference.670.parameters,
      policy_definition_reference.671.parameters,
      policy_definition_reference.672.parameters,
      policy_definition_reference.673.parameters,
      policy_definition_reference.674.parameters,
      policy_definition_reference.675.parameters,
      policy_definition_reference.676.parameters,
      policy_definition_reference.677.parameters,
      policy_definition_reference.678.parameters,
      policy_definition_reference.679.parameters,
      policy_definition_reference.680.parameters,
      policy_definition_reference.681.parameters,
      policy_definition_reference.682.parameters,
      policy_definition_reference.683.parameters,
      policy_definition_reference.684.parameters,
      policy_definition_reference.685.parameters,
      policy_definition_reference.686.parameters,
      policy_definition_reference.687.parameters,
      policy_definition_reference.688.parameters,
      policy_definition_reference.689.parameters,
      policy_definition_reference.690.parameters,
      policy_definition_reference.691.parameters,
      policy_definition_reference.692.parameters,
      policy_definition_reference.693.parameters,
      policy_definition_reference.694.parameters,
      policy_definition_reference.695.parameters,
      policy_definition_reference.696.parameters,
      policy_definition_reference.697.parameters,
      policy_definition_reference.698.parameters,
      policy_definition_reference.699.parameters,
      policy_definition_reference.700.parameters,
      policy_definition_reference.701.parameters,
      policy_definition_reference.702.parameters,
      policy_definition_reference.703.parameters,
      policy_definition_reference.704.parameters,
      policy_definition_reference.705.parameters,
      policy_definition_reference.706.parameters,
      policy_definition_reference.707.parameters,
      policy_definition_reference.708.parameters,
      policy_definition_reference.709.parameters,
      policy_definition_reference.710.parameters,
      policy_definition_reference.711.parameters,
      policy_definition_reference.712.parameters,
      policy_definition_reference.713.parameters,
      policy_definition_reference.714.parameters,
      policy_definition_reference.715.parameters,
      policy_definition_reference.716.parameters,
      policy_definition_reference.717.parameters,
      policy_definition_reference.718.parameters,
      policy_definition_reference.719.parameters,
      policy_definition_reference.720.parameters,
      policy_definition_reference.721.parameters,
      policy_definition_reference.722.parameters,
      policy_definition_reference.723.parameters,
      policy_definition_reference.724.parameters,
      policy_definition_reference.725.parameters,
      policy_definition_reference.726.parameters,
      policy_definition_reference.727.parameters,
      policy_definition_reference.728.parameters,
      policy_definition_reference.729.parameters,
      policy_definition_reference.730.parameters,
      policy_definition_reference.731.parameters,
      policy_definition_reference.732.parameters,
      policy_definition_reference.733.parameters,
      policy_definition_reference.734.parameters,
      policy_definition_reference.735.parameters,
      policy_definition_reference.736.parameters,
      policy_definition_reference.737.parameters,
      policy_definition_reference.738.parameters,
      policy_definition_reference.739.parameters,
      policy_definition_reference.740.parameters,
      policy_definition_reference.741.parameters,
      policy_definition_reference.742.parameters,
      policy_definition_reference.743.parameters,
      policy_definition_reference.744.parameters,
      policy_definition_reference.745.parameters,
      policy_definition_reference.746.parameters,
      policy_definition_reference.747.parameters,
      policy_definition_reference.748.parameters,
      policy_definition_reference.749.parameters,
      policy_definition_reference.750.parameters,
      policy_definition_reference.751.parameters,
      policy_definition_reference.752.parameters,
      policy_definition_reference.753.parameters,
      policy_definition_reference.754.parameters,
      policy_definition_reference.755.parameters,
      policy_definition_reference.756.parameters,
      policy_definition_reference.757.parameters,
      policy_definition_reference.758.parameters,
      policy_definition_reference.759.parameters,
      policy_definition_reference.760.parameters,
      policy_definition_reference.761.parameters,
      policy_definition_reference.762.parameters,
      policy_definition_reference.763.parameters,
      policy_definition_reference.764.parameters,
      policy_definition_reference.765.parameters,
      policy_definition_reference.766.parameters,
      policy_definition_reference.767.parameters,
      policy_definition_reference.768.parameters,
      policy_definition_reference.769.parameters,
      policy_definition_reference.770.parameters,
      policy_definition_reference.771.parameters,
      policy_definition_reference.772.parameters,
      policy_definition_reference.773.parameters,
      policy_definition_reference.774.parameters,
      policy_definition_reference.775.parameters,
      policy_definition_reference.776.parameters,
      policy_definition_reference.777.parameters,
      policy_definition_reference.778.parameters,
      policy_definition_reference.779.parameters,
      policy_definition_reference.780.parameters,
      policy_definition_reference.781.parameters,
      policy_definition_reference.782.parameters,
      policy_definition_reference.783.parameters,
      policy_definition_reference.784.parameters,
      policy_definition_reference.785.parameters,
      policy_definition_reference.786.parameters,
      policy_definition_reference.787.parameters,
      policy_definition_reference.788.parameters,
      policy_definition_reference.789.parameters,
      policy_definition_reference.790.parameters,
      policy_definition_reference.791.parameters,
      policy_definition_reference.792.parameters,
      policy_definition_reference.793.parameters,
      policy_definition_reference.794.parameters,
      policy_definition_reference.795.parameters,
      policy_definition_reference.796.parameters,
      policy_definition_reference.797.parameters,
      policy_definition_reference.798.parameters,
      policy_definition_reference.799.parameters,
      policy_definition_reference.800.parameters,
      policy_definition_reference.801.parameters,
      policy_definition_reference.802.parameters,
      policy_definition_reference.803.parameters,
      policy_definition_reference.804.parameters,
      policy_definition_reference.805.parameters,
      policy_definition_reference.806.parameters,
      policy_definition_reference.807.parameters,
      policy_definition_reference.808.parameters,
      policy_definition_reference.809.parameters,
      policy_definition_reference.810.parameters,
      policy_definition_reference.811.parameters,
      policy_definition_reference.812.parameters,
      policy_definition_reference.813.parameters,
      policy_definition_reference.814.parameters,
      policy_definition_reference.815.parameters,
      policy_definition_reference.816.parameters,
      policy_definition_reference.817.parameters,
      policy_definition_reference.818.parameters,
      policy_definition_reference.819.parameters,
      policy_definition_reference.820.parameters,
      policy_definition_reference.821.parameters,
      policy_definition_reference.822.parameters,
      policy_definition_reference.823.parameters,
      policy_definition_reference.824.parameters,
      policy_definition_reference.825.parameters,
      policy_definition_reference.826.parameters,
      policy_definition_reference.827.parameters,
      policy_definition_reference.828.parameters,
      policy_definition_reference.829.parameters,
      policy_definition_reference.830.parameters,
      policy_definition_reference.831.parameters,
      policy_definition_reference.832.parameters,
      policy_definition_reference.833.parameters,
      policy_definition_reference.834.parameters,
      policy_definition_reference.835.parameters,
      policy_definition_reference.836.parameters,
      policy_definition_reference.837.parameters,
      policy_definition_reference.838.parameters,
      policy_definition_reference.839.parameters,
      policy_definition_reference.840.parameters,
      policy_definition_reference.841.parameters,
      policy_definition_reference.842.parameters,
      policy_definition_reference.843.parameters,
      policy_definition_reference.844.parameters,
      policy_definition_reference.845.parameters,
      policy_definition_reference.846.parameters,
      policy_definition_reference.847.parameters,
      policy_definition_reference.848.parameters,
      policy_definition_reference.849.parameters,
      policy_definition_reference.850.parameters,
      policy_definition_reference.851.parameters,
      policy_definition_reference.852.parameters,
      policy_definition_reference.853.parameters,
      policy_definition_reference.854.parameters,
      policy_definition_reference.855.parameters,
      policy_definition_reference.856.parameters,
      policy_definition_reference.857.parameters,
      policy_definition_reference.858.parameters,
      policy_definition_reference.859.parameters,
      policy_definition_reference.860.parameters,
      policy_definition_reference.861.parameters,
      policy_definition_reference.862.parameters,
      policy_definition_reference.863.parameters,
      policy_definition_reference.864.parameters,
      policy_definition_reference.865.parameters,
      policy_definition_reference.866.parameters,
      policy_definition_reference.867.parameters,
      policy_definition_reference.868.parameters,
      policy_definition_reference.869.parameters,
      policy_definition_reference.870.parameters,
      policy_definition_reference.871.parameters,
      policy_definition_reference.872.parameters,
      policy_definition_reference.873.parameters,
      policy_definition_reference.874.parameters,
      policy_definition_reference.875.parameters,
      policy_definition_reference.876.parameters,
      policy_definition_reference.877.parameters,
      policy_definition_reference.878.parameters,
      policy_definition_reference.879.parameters,
      policy_definition_reference.880.parameters,
      policy_definition_reference.881.parameters,
      policy_definition_reference.882.parameters,
      policy_definition_reference.883.parameters,
      policy_definition_reference.884.parameters,
      policy_definition_reference.885.parameters,
      policy_definition_reference.886.parameters,
      policy_definition_reference.887.parameters,
      policy_definition_reference.888.parameters,
      policy_definition_reference.889.parameters,
      policy_definition_reference.890.parameters,
      policy_definition_reference.891.parameters,
      policy_definition_reference.892.parameters,
      policy_definition_reference.893.parameters,
      policy_definition_reference.894.parameters,
      policy_definition_reference.895.parameters,
      policy_definition_reference.896.parameters,
      policy_definition_reference.897.parameters,
      policy_definition_reference.898.parameters,
      policy_definition_reference.899.parameters,
      policy_definition_reference.900.parameters,
      policy_definition_reference.901.parameters,
      policy_definition_reference.902.parameters,
      policy_definition_reference.903.parameters,
      policy_definition_reference.904.parameters,
      policy_definition_reference.905.parameters,
      policy_definition_reference.906.parameters,
      policy_definition_reference.907.parameters,
      policy_definition_reference.908.parameters,
      policy_definition_reference.909.parameters,
      policy_definition_reference.910.parameters,
      policy_definition_reference.911.parameters,
      policy_definition_reference.912.parameters,
      policy_definition_reference.913.parameters,
      policy_definition_reference.914.parameters,
      policy_definition_reference.915.parameters,
      policy_definition_reference.916.parameters,
      policy_definition_reference.917.parameters,
      policy_definition_reference.918.parameters,
      policy_definition_reference.919.parameters,
      policy_definition_reference.920.parameters,
      policy_definition_reference.921.parameters,
      policy_definition_reference.922.parameters,
      policy_definition_reference.923.parameters,
      policy_definition_reference.924.parameters,
      policy_definition_reference.925.parameters,
      policy_definition_reference.926.parameters,
      policy_definition_reference.927.parameters,
      policy_definition_reference.928.parameters,
      policy_definition_reference.929.parameters,
      policy_definition_reference.930.parameters,
      policy_definition_reference.931.parameters,
      policy_definition_reference.932.parameters,
      policy_definition_reference.933.parameters,
      policy_definition_reference.934.parameters,
      policy_definition_reference.935.parameters,
      policy_definition_reference.936.parameters,
      policy_definition_reference.937.parameters,
      policy_definition_reference.938.parameters,
      policy_definition_reference.939.parameters,
      policy_definition_reference.940.parameters,
      policy_definition_reference.941.parameters,
      policy_definition_reference.942.parameters,
      policy_definition_reference.943.parameters,
      policy_definition_reference.944.parameters,
      policy_definition_reference.945.parameters,
      policy_definition_reference.946.parameters,
      policy_definition_reference.947.parameters,
      policy_definition_reference.948.parameters,
      policy_definition_reference.949.parameters,
      policy_definition_reference.950.parameters,
      policy_definition_reference.951.parameters,
      policy_definition_reference.952.parameters,
      policy_definition_reference.953.parameters,
      policy_definition_reference.954.parameters,
      policy_definition_reference.955.parameters,
      policy_definition_reference.956.parameters,
      policy_definition_reference.957.parameters,
      policy_definition_reference.958.parameters,
      policy_definition_reference.959.parameters,
      policy_definition_reference.960.parameters,
      policy_definition_reference.961.parameters,
      policy_definition_reference.962.parameters,
      policy_definition_reference.963.parameters,
      policy_definition_reference.964.parameters,
      policy_definition_reference.965.parameters,
      policy_definition_reference.966.parameters,
      policy_definition_reference.967.parameters,
      policy_definition_reference.968.parameters,
      policy_definition_reference.969.parameters,
      policy_definition_reference.970.parameters,
      policy_definition_reference.971.parameters,
      policy_definition_reference.972.parameters,
      policy_definition_reference.973.parameters,
      policy_definition_reference.974.parameters,
      policy_definition_reference.975.parameters,
      policy_definition_reference.976.parameters,
      policy_definition_reference.977.parameters,
      policy_definition_reference.978.parameters,
      policy_definition_reference.979.parameters,
      policy_definition_reference.980.parameters,
      policy_definition_reference.981.parameters,
      policy_definition_reference.982.parameters,
      policy_definition_reference.983.parameters,
      policy_definition_reference.984.parameters,
      policy_definition_reference.985.parameters,
      policy_definition_reference.986.parameters,
      policy_definition_reference.987.parameters,
      policy_definition_reference.988.parameters,
      policy_definition_reference.989.parameters,
      policy_definition_reference.990.parameters,
      policy_definition_reference.991.parameters,
      policy_definition_reference.992.parameters,
      policy_definition_reference.993.parameters,
      policy_definition_reference.994.parameters,
      policy_definition_reference.995.parameters,
      policy_definition_reference.996.parameters,
      policy_definition_reference.997.parameters,
      policy_definition_reference.998.parameters,
      policy_definition_reference.999.parameters,
      policy_definition_reference.1000.parameters,
    ] // hacky hack hack, always says it has changed!
  }
}

